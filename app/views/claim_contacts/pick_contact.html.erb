<%= render partial: 'claims/claimleftmenu' %>
<%= render partial: 'claims/claimsummarymenu' %>

<div class="with-iconav">
  <div class="container-fluid-middle">
    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            Add existing Contact
          </div>
          </br>
          <div class="panel-body">
            <div class="row">
              <%= form_tag("/claims/#{@claim.id}/contacts/save_contact") do %>
                <div class="col-md-12">
                  <div class="form-group">
                    <label>Please search contact's email to add:</label>
                    <%= text_field_tag "contact_picker", '', autocomplete: "on", id: 'contact_picker', class: 'form-control' %>
                    <%= hidden_field_tag "contact_id", '', id: 'contact_id'%>
                  </div>
                  <div class="text-center">
                    <%= submit_tag "Save", class: "btn btn-form" %>
                  </div>
                </div>
              <% end %>
            </div>  
          </div>
        </div>
      </div>
    </div>
  </div>
</div>  
<script type="text/javascript">

  $(function() {
    $('#contact_picker').autocomplete({
      minLength: 2,
      source: "<%= existing_contacts_claim_contacts_path(@claim) %>",
      select: function(event, ui){
        if(ui.item.id !== undefined){
          $('#contact_id').prop('value', ui.item.id)
        }
      }
    });
  });

</script>        